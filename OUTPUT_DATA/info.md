# Страницы прототипа: краткая документация

Документ описывает две страницы **тестового прототипа** двух основных страниц проекта: **ввод кода ТН ВЭД** и **дашборд по выбранному товару**. Основано на исходниках `input_obj_name.jsx` и `output_obj.jsx`.

---

## 1) Выбор товара по коду ТН ВЭД

**Компонент:** `ProductCodeInputRU` (рендерится по умолчанию из `App`)
**Цель:** пользователю ввести или выбрать код ТН ВЭД и перейти к дашборду.

### Состав страницы
- **Шапка:** бренд-строка и заголовок «Выбор товара по коду ТН ВЭД»; значок `Info` с подсказкой по вводу.
- **Карточка «Код ТН ВЭД»:**
  - Поле ввода с `datalist` (автодополнение по известным кодам). В демо — один товар *«Поликарбонат гранулированный»* (`3907 40 000 0`).
  - Кнопка **«Продолжить»**; при валидном коде — переход к дашборду. При невалидном — выводится текст ошибки.

### Логика/валидация
- Нормализация кода `normalizeCode`: убирает пробелы для сравнения (e.g. `3907 40 000 0` → `3907400000`).
- Проверка кода против массива `KNOWN_PRODUCTS`; в демо — один элемент: `{ name, codeDisplay, codeValue }`.
- Мини-самопроверки (console.warn) для нормализации и наличия демо-кода.

### Навигация
- Мини-«роутер» в `App`: состояния `selector | dashboard`. Успешное подтверждение кода переключает на `dashboard`. Поддержан быстрый вход по якорю `#dashboard`.

---

## 2) Дашборд по выбранному товару

**Компоненты:**  
- Вариант 1 (модульный): `CustomsDashboardRU` + блоки `GeoPieBlock`, `DynamicsBlock`, `PricesPieBlock` (файл `input_obj_name.jsx`). 
- Вариант 2 (моно): цельная страница `CustomsDashboardRU` (файл `output_obj.jsx`). Логика и структура идентичны.

### Назначение
Показать базовые реквизиты товара, суммарные рекомендации по регулированию и три визуализации: география импорта, динамика показателей, цены топ-5 стран.

### Структура
1. **Шапка** (бренд-строка + H1 «Дашборд по выбранному товару»).
2. **Информация о товаре** (карточка):
   - Наименование, код ТН ВЭД (пробрасываются пропсами/выбором).  
   - «Текущая ставка» — **10%**, «Ставка по обязательствам РФ в ВТО» — **8%** (демо-значения).
3. **Рекомендации по регулированию** (карточка-акцент):
   - Итог: **сохранить 10%**, установить **коридор 8–10%**; при доле импорта в потреблении > **55%** — **тарифная квота** (до порога 8%, сверх — 10%).
   - Быстрые метрики 2022→2024: импорт **33%**, производство **38%**, потребление **22%** (расчёт по демо-рядам).
4. **Географическая структура импорта** (круговая диаграмма + правая легенда):  
   - Доли стран: Китай 45, Германия 25, Италия 15, Турция 10, Прочие 5 (в сумме 100). Наведение — подсветка и подсказка.
5. **Динамика (3 года)** (линейный график на одном холсте):  
   - Ряды: *Импорт, Производство, Потребление* за 2022–2024; единицы подписи оси: «тыс. т».
6. **Средние контрактные цены (топ-5), USD/т** (круговая + легенда):  
   - Китай 120, Германия 140, Италия 130, Турция 115, Южная Корея 150. Наведение — подсказка.
7. **Экспорт**: кнопки «Выгрузить PDF/Word» — **заглушки** (показывают временное сообщение).

### Данные и вычисления (демо)
- **Ряды динамики (2022–2024):** `{Импорт, Производство, Потребление}` → используются для метрик роста и линейного графика.
- **География импорта:** массив `{ name, value }`, сумма = 100.
- **Цены (USD/т):** массив `{ name, value }` для топ-5.
- **Метрики роста:** `Math.round((x_2024 - x_2022)/x_2022 * 100)` — для импорта (**33%**), производства (**38%**), потребления (**22%**).
- **Мини-самопроверки:** контроль суммы долей, длины топ-5 и ожидаемых процентных приростов (через `console.warn`).

### Взаимодействия/UX
- Hover по секторам круговых — фиксация активного элемента и его отображение в правой панели.
- Кнопки экспорта показывают всплывающее уведомление вверху контента (motion-вход/выход).
- Инфо-кнопки (`InfoButton`) раскрывают подсказку по ховеру.

### Визуал/цвета
- **Линии:** Импорт `#D32F2F`, Производство `#2E7D32`, Потребление `#1565C0`.  
- **Пироги:** палитра `["#1565C0","#2E7D32","#F57C00","#6A1B9A","#D32F2F"]`.  
- Единый «гос-портальный» стиль: светлый фон, карточки с левым цветным бордером.

---

## Технологии

- **React (hooks)**, **shadcn/ui** (`Card`, `Button`), **lucide-react** (`Info`, `Download`), **recharts** (LineChart, PieChart), **framer-motion** для уведомлений. :contentReference[oaicite:31]{index=31}

---

## Подключение реальных данных (план)

1. Заменить демо-массивы `dynamics`, `geo`, `avgPrices` на загрузку из API.  
2. Пересчитать метрики роста и рекомендации по поступившим данным.  
3. Реализовать экспорт PDF/Word (сейчас — заглушки). :contentReference[oaicite:32]{index=32}

---

## Быстрые шпаргалки для разработчика

```js
// Нормализация кода ТН ВЭД (ввод может быть с пробелами):
const normalizeCode = (s) => s.replace(/\s+/g, "");
// Пример: "3907 40 000 0" -> "3907400000"
```


```js
// Метрика роста % (2022 -> 2024)
const growth = (v2022, v2024) => Math.round(((v2024 - v2022) / v2022) * 100);
```


```jsx
// Подсказка (hover):
<InfoButton text="Краткое пояснение по блоку" />
```


---

## Сценарий пользователя (end-to-end)

1. Открывает страницу **ввода кода**, начинает печатать и выбирает подсказку `3907 40 000 0`.  
2. Жмёт **«Продолжить»** — попадает на **дашборд** выбранного товара.  
3. Смотрит блок «Информация о товаре», далее — **итоговую рекомендацию**.  
4. Изучает **географию импорта**, **динамику** и **цены**.  
5. При попытке экспорта видит сообщение о том, что функция будет доступна в релизе.
